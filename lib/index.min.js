'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};Object.defineProperty(exports,'__esModule',{value:!0});exports.initializeStore=initializeStore,exports.getStore=getStore,exports.updateStore=updateStore,exports.addObserver=addObserver;var observers=[],store={},persistedStateKeys=void 0,persistStorage=void 0,persistTimeout=void 0;function initializeStore(a){var b={};a.persist&&(persistStorage=a.persist.storage,b=a.persist.restore(JSON.parse(persistStorage.getItem('fluxible-js'))||{}),persistedStateKeys=Object.keys(b)),store=_extends({},a.initialStore,b)}function getStore(){return store}function updateStore(a){store=_extends({},store,a),persistTimeout&&clearTimeout(persistTimeout);var b=Object.keys(a);observers.forEach(function(c){for(var d=0;d<b.length;d++)if(-1!==c.states.indexOf('{'+b[d]+'}')){c.callback(store);break}}),persistedStateKeys&&(persistTimeout=setTimeout(function(){for(var b={},c=0;c<persistedStateKeys.length;c++)b[persistedStateKeys[c]]=store[persistedStateKeys[c]];persistStorage.setItem('fluxible-js',JSON.stringify(b))},200))}function addObserver(a,b){var c={callback:a,states:b.map(function(a){return'{'+a+'}'}).join(' ')};return observers.push(c),function(){observers.splice(observers.indexOf(c),1)}}