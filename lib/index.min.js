'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),exports.initializeStore=initializeStore,exports.getStore=getStore,exports.updateStore=updateStore,exports.addObserver=addObserver;var observers=[],store={},persistedStateKeys=null,persistStorage=null,persistTimeout=null;function initializeStore(b){var c=Object.keys(b.initialStore);if(b.persist!==void 0){for(var d=b.persist.restore(JSON.parse(b.persist.storage.getItem('fluxible-js'))||{}),e=0;e<c.length;e++)store[c[e]]=d[c[e]]||b.initialStore[c[e]];persistedStateKeys=Object.keys(d),persistStorage=b.persist.storage}else for(var f=0;f<c.length;f++)store[c[f]]=b.initialStore[c[f]]}function getStore(){return store}function updateStore(c){null!==persistedStateKeys&&(null!==persistTimeout&&clearTimeout(persistTimeout),persistTimeout=setTimeout(function(){persistStorage.setItem('fluxible-js',JSON.stringify(persistedStateKeys.reduce(function(a,b){return a[b]=store[b],a},{})))},200));for(var d=Object.keys(c),e=0;e<d.length;e++)store[d[e]]=c[d[e]];for(var f=0;f<observers.length;f++)if(d.length<observers[f].wantedKeys.length){for(var g=0;g<d.length;g++)if(-1!==observers[f].wantedKeys.indexOf(d[g])){observers[f].callback(store);break}}else for(var b=0;b<observers[f].wantedKeys.length;b++)if(-1!==d.indexOf(observers[f].wantedKeys[b])){observers[f].callback(store);break}}function addObserver(a,b){var c={callback:a,wantedKeys:b,id:Math.random()};return observers.push(c),function(){for(var b=0;b<observers.length;b++)if(observers[b].id===c.id)return observers.splice(b,1)}}